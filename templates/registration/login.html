{% extends 'base.html' %}

{% block title %}Login - Scheduler App{% endblock %}

{% block content %}
<div class="card">
    <h1>Login</h1>
    <p style="margin: 1rem 0;">Please enter your credentials to login.</p>

    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}

        <div style="margin-top: 1rem; margin-bottom: 1rem;">
            <label for="remember_me" id="remember-label" style="display: flex; align-items: center; cursor: pointer; padding: 12px; margin: -12px;">
                <input type="checkbox" name="remember_me" id="remember_me" style="margin-right: 0.5rem; width: auto; cursor: pointer;">
                <span style="font-weight: bold;">Keep me signed in</span>
            </label>
            <div id="remember-tooltip" style="display: none; position: absolute; background-color: #2c3e50; color: white; padding: 0.5rem; border-radius: 4px; font-size: 0.85rem; white-space: nowrap; z-index: 1000; pointer-events: none;">Stay signed in for 1 year</div>
        </div>

        <div style="margin-top: 1.5rem;">
            <button type="submit" class="btn">Login</button>
            <a href="{% url 'home' %}" class="btn btn-secondary" style="margin-left: 1rem;">Cancel</a>
        </div>
    </form>

    <p style="margin-top: 1.5rem;">
        <a href="{% url 'forgot_password' %}">Forgot your password?</a> |
        <a href="{% url 'recover_username' %}">Forgot your username?</a>
    </p>

    <p style="margin-top: 0.5rem;">
        Don't have an account? <a href="{% url 'register' %}">Register here</a>
    </p>
</div>

<style>
    /* Make checkbox cursor pointer */
    input[type="checkbox"] {
        cursor: pointer !important;
    }
    label:has(input[type="checkbox"]) {
        cursor: pointer !important;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const label = document.getElementById('remember-label');
    const tooltip = document.getElementById('remember-tooltip');
    const card = document.querySelector('.card');
    let showTimeout = null;
    let mouseX = 0;
    let mouseY = 0;

    label.addEventListener('mouseenter', function(e) {
        mouseX = e.clientX;
        mouseY = e.clientY;
        showTimeout = setTimeout(function() {
            positionTooltip();
            tooltip.style.display = 'block';
        }, 100);
    });

    label.addEventListener('mousemove', function(e) {
        mouseX = e.clientX;
        mouseY = e.clientY;
        if (tooltip.style.display === 'block') {
            positionTooltip();
        }
    });

    label.addEventListener('mouseleave', function() {
        if (showTimeout) {
            clearTimeout(showTimeout);
            showTimeout = null;
        }
        tooltip.style.display = 'none';
    });

    function positionTooltip() {
        const cardRect = card.getBoundingClientRect();
        const tooltipRect = tooltip.getBoundingClientRect();

        // Position tooltip near cursor with offset
        let left = mouseX + 10;
        let top = mouseY + 15;

        // Keep within container horizontally
        if (left + tooltipRect.width > cardRect.right) {
            left = cardRect.right - tooltipRect.width - 5;
        }
        if (left < cardRect.left) {
            left = cardRect.left + 5;
        }

        // Keep within container vertically
        if (top + tooltipRect.height > cardRect.bottom) {
            top = mouseY - tooltipRect.height - 10;
        }
        if (top < cardRect.top) {
            top = cardRect.top + 5;
        }

        tooltip.style.left = left + 'px';
        tooltip.style.top = top + 'px';
    }
});
</script>
{% endblock %}
